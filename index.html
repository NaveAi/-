<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>עדכונים</title>
</head>
<body>
    <div class="total-price" id="totalPrice">
        <span>סה"כ:</span>
        <span id="SumTotal">₪0</span>
    </div>
    <h1>הזמנה לשבת אירוח</h1>
    <h2 class="header-fixed">פרטי ההזמנה</h2>

    <form id="bookingForm">
        <label for="name">שם מלא:</label>
        <input type="text" id="name" name="name" required>

        <label for="email">כתובת אימייל:</label>
        <input type="email" id="email" name="email" required>

        <label for="phone">מספר טלפון:</label>
        <input type="tel" id="phone" name="phone" required>

        <label for="OrderDate">:תאריך ההזמנה</label>
        <input type="date" id="OrderDate" name="OrderDate" required>
        <span id="dayOfWeekResult"></span>

        <div class="hidden-menu" id="Saturday">
            <div class="header-fixed">
                <div class="sleep-header-container">
                    <h2 id="sleep-header">לינה:</h2>
                    <span class="sleep-subtext">(אם אינכם מעוניינים בלינה- דלגו הלאה ל'תפריט')</span>
                </div>
            </div>
            <div class="sleep-part">
                <h3>שימו לב!</h3>
                <div class="comment-sleep">
                    <li>המחיר אינו כולל כלי מיטה וכלי רחצה</li>
                    <li>כל חדר מכיל 5 - 7 מיטות</li>
                </div>
                <div id="options">
                    <button name="option" value="yeshiva">ישיבה תיכונית</button>
                    <button name="option" value="ulpena">אולפנה</button>
                    <button name="option" value="haluzey">חלוצי דרור</button>
                </div>
                <div id="locations">
                    <span id="ulpena" class="hidden-menu">
                        <h2>בחירת חדרים באולפנה:</h2>
                        <div id="place-a">
                            <div class="floor-1">
                                <h3>קומה ראשונה</h3>
                                <div class="room-map">
                                    <div class="room" data-room="0" data-price="300">חדר 0<br>₪300</div>
                                    <div class="room" data-room="2" data-price="300">חדר 2<br>₪300</div>
                                    <div class="room" data-room="3" data-price="300">חדר 3<br>₪300</div>
                                    <div class="room" data-room="4" data-price="300">חדר 4<br>₪300</div>
                                    <div class="room" data-room="5" data-price="300">חדר 5<br>₪300</div>
                                    <div class="room" data-room="6" data-price="300">חדר 6<br>₪300</div>
                                    <div class="room" data-room="7" data-price="300">חדר 7<br>₪300</div>
                                    <div class="room" data-room="8" data-price="300">חדר 8<br>₪300</div>
                                    <div class="room" data-room="9" data-price="300">חדר 9<br>₪300</div>
                                    <div class="room" data-room="10" data-price="300">חדר 10<br>₪300</div>
                                </div>
                            </div>
                        </div>
                        <div id="place-a">
                            <div class="floor-2">
                                <h3 id="-floor">קומה שנייה</h3>
                                <div class="room-map">
                                    <div class="room" data-room="11" data-price="300">חדר 11<br>₪300</div>
                                    <div class="room" data-room="12" data-price="300">חדר 12<br>₪300</div>
                                    <div class="room" data-room="13" data-price="300">חדר 13<br>₪300</div>
                                    <div class="room" data-room="14" data-price="300">חדר 14<br>₪300</div>
                                    <div class="room" data-room="15" data-price="300">חדר 15<br>₪300</div>
                                    <div class="room" data-room="16" data-price="300">חדר 16<br>₪300</div>
                                    <div class="room" data-room="17" data-price="300">חדר 17<br>₪300</div>
                                    <div class="room" data-room="18" data-price="300">חדר 18<br>₪300</div>
                                    <div class="room" data-room="19" data-price="300">חדר 19<br>₪300</div>
                                    <div class="room" data-room="20" data-price="300">חדר 20<br>₪300</div>
                                    <div class="room" data-room="21" data-price="300">חדר 21<br>₪300</div>
                                    <div class="room" data-room="22" data-price="300">חדר 22<br>₪300</div>
                                </div>
                            </div>
                        </div>
                    </span>
                    <span class="hidden-menu" id="yeshiva">
                        <h2>בחירת חדרים בישיבה תיכונית:</h2>
                        <div class="places" id="place-a">
                            <h3>מתחם ראשי</h3>
                            <div class="floor-1">
                                <h3>קומה ראשונה</h3>
                                <div class="room-map">
                                    <div class="room" data-room="0" data-price="300">חדר 0<br>₪300</div>
                                    <div class="room" data-room="1" data-price="300">חדר 1<br>₪300</div>
                                    <div class="room" data-room="2" data-price="300">חדר 2<br>₪300</div>
                                    <div class="room" data-room="3" data-price="300">חדר 3<br>₪300</div>
                                    <div class="room" data-room="4" data-price="300">חדר 4<br>₪300</div>
                                    <div class="room" data-room="5" data-price="300">חדר 5<br>₪300</div>
                                    <div class="room" data-room="6" data-price="300">חדר 6<br>₪300</div>
                                    <div class="room" data-room="7" data-price="300">חדר 7<br>₪300</div>
                                    <div class="room" data-room="8" data-price="300">חדר 8<br>₪300</div>
                                    <div class="room" data-room="9" data-price="300">חדר 9<br>₪300</div>
                                    <div class="room" data-room="10" data-price="300">חדר 10<br>₪300</div>
                                </div>
                            </div>
                        </div>
                        <div class="places" id="place-a">
                            <div class="floor-2">
                                <h3>קומה שנייה</h3> 
                                <div class="room-map">
                                    <div class="room" data-room="11" data-price="300">חדר 11<br>₪300</div>
                                    <div class="room" data-room="12" data-price="300">חדר 12<br>₪300</div>
                                    <div class="room" data-room="13" data-price="300">חדר 13<br>₪300</div>
                                    <div class="room" data-room="14" data-price="300">חדר 14<br>₪300</div>
                                    <div class="room" data-room="15" data-price="300">חדר 15<br>₪300</div>
                                    <div class="room" data-room="16" data-price="300">חדר 16<br>₪300</div>
                                    <div class="room" data-room="17" data-price="300">חדר 17<br>₪300</div>
                                    <div class="room" data-room="18" data-price="300">חדר 18<br>₪300</div>
                                    <div class="room" data-room="19" data-price="300">חדר 19<br>₪300</div>
                                    <div class="room" data-room="20" data-price="300">חדר 20<br>₪300</div>
                                    <div class="room" data-room="21" data-price="300">חדר 21<br>₪300</div>
                                    <div class="room" data-room="22" data-price="300">חדר 22<br>₪300</div>
                                </div>
                            </div>
                        </div>
                        <div class="places" id="place-b">
                            <h3>מתחם חדש א'</h3>
                            <div class="room-map">
                                <div class="BigApartment">
                                    <div class="room" data-room="דירה גדולה 1" data-price="500">דירה גדולה<br>3 חדרים<br>₪500</div>
                                </div>
                                <div class="room" data-room="4" data-price="300">חדר 4<br>₪300</div>
                                <div class="room" data-room="5" data-price="300">חדר 5<br>₪300</div>   
                                <div class="BigApartment">
                                    <div class="room" data-room="6" data-price="500">דירה גדולה<br>3 חדרים<br>₪500</div>
                                </div>
                            </div>
                        </div>
                        <div class="places" id="place-c">
                            <h3>מתחם חדש ב'</h3>
                            <div class="room-map">
                                <div class="room" data-room="1" data-price="400">חדר 1<br>₪400</div>
                                <div class="room" data-room="2" data-price="400">חדר 2<br>₪400</div>
                                <div class="room" data-room="3" data-price="400">חדר 3<br>₪400</div>
                                <div class="room" data-room="4" data-price="400">חדר 4<br>₪400</div>
                                <div class="room" data-room="5" data-price="400">חדר 5<br>₪400</div>
                                <div class="room" data-room="6" data-price="400">חדר 6<br>₪400</div>
                                <div class="room" data-room="7" data-price="400">חדר 7<br>₪400</div>
                            </div>
                        </div>
                    </span>
                    <span class="hidden-menu" id="haluzey">
                        <h2>בחירת חדרים בחלוצי דרור:</h2>
                        <div class="room-map" id="place-a">
                            <div class="room" data-room="1" data-price="500">חדר 1<br>₪500</div>
                            <div class="room" data-room="2" data-price="500">חדר 2<br>₪500</div>
                            <div class="room" data-room="3" data-price="500">חדר 3<br>₪500</div>
                            <div class="room" data-room="4" data-price="500">חדר 4<br>₪500</div>
                            <div class="room" data-room="5" data-price="500">חדר 5<br>₪500</div>
                            <div class="room" data-room="6" data-price="500">חדר 6<br>₪500</div>
                            <div class="room" data-room="7" data-price="500">חדר 7<br>₪500</div>
                            <div class="room" data-room="8" data-price="500">חדר 8<br>₪500</div>
                            <div class="room" data-room="9" data-price="500">חדר 9<br>₪500</div>
                            <div class="room" data-room="10" data-price="500">חדר 10<br>₪500</div>
                            <div class="room" data-room="10" data-price="500">חדר 11<br>₪500</div>
                            <div class="room" data-room="10" data-price="500">חדר 12<br>₪500</div>
                            <div class="room" data-room="10" data-price="500">חדר 13<br>₪500</div>
                        </div>
                    </span>
                </div>
            </div>
            <section id="menuSection">
                <h2 class="header-fixed">תפריט</h2>
                <div id="mealSelection">
                    <button class="menu-button-meal" onclick="showMealOptions('dinner')">ארוחת ערב</button>
                    <button class="menu-button-meal" onclick="showMealOptions('breakfast')">ארוחת בוקר</button>
                    <button class="menu-button-meal" onclick="showMealOptions('night')">אוכל לילה</button>
                </div>
                <div id="menuOptions" class="hidden">
                    <!-- Menu options will be dynamically populated based on the selected meal -->
                </div>
                <div>
                    <label for="numberOfMeals">מספר סועדים:</label>
                    <input type="number" id="numberOfMeals" min="50" value="50">
                </div>
            </section>
        </div>
        
    

        <div class="hidden-menu" id="MidWeek">
            <h2 class="header-fixed">תפריט אמצע שבוע:</h2>
        </div>

        <h2 class="finish-header">סיום</h2>
        <div id="orderSummary"></div>

        <label for="specialRequests">בקשות מיוחדות:</label>
        <textarea id="specialRequests" name="specialRequests" rows="4"></textarea>
    </form>

    <h3 class="">לסיום ההזמנה יש לשתף דרך הווטסאפ או המייל:</h3>
    <div class="share-buttons">
        <div class="share-button" id="WhatsappShare" onclick="shareOnWhatsApp()">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRp95BO6ix2nKMKRuSiiGgU9o2i6I9ADVyPhw&s" alt="WhatsApp">
        </div>
        <div class="share-button" id="MailShare" onclick="shareOnMail()">
            <img src="data:image/png;base64,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" alt="Email">
        </div>
    </div>
    <script>
        const menuButtons = document.querySelectorAll('#mealSelection button, #menuOptions button');

// הוסף מאזין אירועים לכל כפתור
        menuButtons.forEach(button => {
        button.addEventListener('click', function(event) {
            // מנע את ברירת המחדל של הדפדפן (שיכולה לגרום לרענון)
            event.preventDefault();
        });
    });
            // Global variables
        // Global variables
let totalPrice = 0;
const selectedRooms = {};
const selectedItems = {
    dinner: { starters: [], mains: [], sides: [], salads: [], desserts: [] },
    breakfast: { mains: [], sides: [], salads: [], desserts: [] },
    night: []
};

const meals = {
    dinner: {
        starters: ['סלט ירוק', 'מרק היום', 'ברוסקטה', 'קרפצ׳יו בקר'],
        mains: ['דג סלמון', 'עוף צלוי', 'בשר בקר', 'טופו מוקפץ'],
        sides: ['אורז', 'תפוחי אדמה', 'ירקות צלויים', 'פסטה', 'קינואה'],
        salads: ['סלט ירקות', 'סלט כרוב', 'סלט חומוס', 'סלט קינואה', 'סלט עדשים', 'סלט פסטה', 'טאבולה', 'סלט ביצים'],
        desserts: ['עוגת שוקולד', 'פירות העונה', 'סורבה', 'טירמיסו']
    },
    breakfast: {
        mains: ['ביצים לבחירה', 'שקשוקה', 'חביתת ירק', 'בלינצ׳ס'],
        sides: ['לחמים', 'מאפים', 'גבינות', 'יוגורט', 'דגני בוקר'],
        salads: ['סלט ירקות קצוץ', 'סלט אבוקדו', 'סלט טונה', 'סלט ביצים', 'חציל בטחינה', 'חומוס', 'טחינה', 'סלט קינואה'],
        desserts: ['עוגת גבינה', 'מוזלי', 'פנקייק', 'ריבות']
    },
    night: ['סלמון שלם', 'מגש גבינות', 'כדורי פירה', 'ג׳חנון ורסק + ביצים', 'בורקס תפו״א', 'סלט טונה']
};

// Utility functions
function $(id) {
    return document.getElementById(id);
}

function updateTotalPrice() {
    $('SumTotal').textContent = '₪' + totalPrice;
}

// Room selection
function initRoomSelection() {
    document.querySelectorAll('.room').forEach(room => {
        room.addEventListener('click', function(event) {
            event.preventDefault();
            toggleRoomSelection(this);
        });
    });
}

function toggleRoomSelection(roomElement) {
    const roomNumber = roomElement.dataset.room;
    const roomPrice = parseInt(roomElement.dataset.price);

    if (isNaN(roomPrice)) {
        console.error('Invalid price for room: ' + roomNumber);
        return;
    }

    const placeElement = roomElement.closest('[id^="place-"]');
    const complexElement = roomElement.closest('.hidden-menu');

    if (!placeElement || !complexElement) {
        console.error('Could not find parent elements for room: ' + roomNumber);
        return;
    }

    const placeId = placeElement.id;
    const complexId = complexElement.id;

    const placeName = getPlaceName(placeId);
    const complexName = getComplexName(complexId, placeId);

    const roomKey = complexId + '-' + placeId + '-' + roomNumber;

    if (roomElement.classList.toggle('selected')) {
        selectedRooms[roomKey] = { complex: complexName, number: roomNumber, price: roomPrice };
        totalPrice += roomPrice;
    } else {
        delete selectedRooms[roomKey];
        totalPrice -= roomPrice;
    }
    
    updateTotalPrice();
    calculateTotal(); // Update the total price including room prices
    console.log("Selected rooms:", selectedRooms);
    console.log("Total price:", totalPrice);
}

function getPlaceName(placeId) {
    const placeNames = {
        'place-a': 'מתחם ראשי',
        'place-b': 'מתחם חדש א',
        'place-c': 'מתחם חדש ב'
    };
    return placeNames[placeId] || '';
}

function getComplexName(complexId, placeId) {
    if (complexId === 'ulpena') return 'אולפנה';
    if (complexId === 'yeshiva') {
        const placeNames = {
            'place-a': 'ישיבה תיכונית מתחם ראשי',
            'place-b': 'ישיבה תיכונית מתחם חדש א',
            'place-c': 'ישיבה תיכונית מתחם חדש ב'
        };
        return placeNames[placeId] || '';
    }
    if (complexId === 'haluzey') return 'חלוצי דרור';
    return '';
}

// Meal selection
function showMealOptions(meal) {
    const menuOptions = $('menuOptions');
    menuOptions.innerHTML = '';
    menuOptions.classList.remove('hidden');

    // Remove 'selected' class from all meal selection buttons
    document.querySelectorAll('#mealSelection button').forEach(button => {
        button.classList.remove('selected');
    });

    // Add 'selected' class to the clicked button
    event.target.classList.add('selected');

    if (meal === 'night') {
        const nightDiv = createCategoryDiv('אוכל לילה (בחר 4 פריטים)', meals.night, meal);
        menuOptions.appendChild(nightDiv);
    } else {
        for (const category in meals[meal]) {
            const categoryDiv = createCategoryDiv(getCategoryTitle(category), meals[meal][category], meal, category);
            menuOptions.appendChild(categoryDiv);
        }
    }

    updateSummary();
}

function createCategoryDiv(title, items, meal, category = null) {
    const categoryDiv = document.createElement('div');
    categoryDiv.className = 'menu-category';
    categoryDiv.innerHTML = '<h3>' + title + '</h3>';

    items.forEach(item => {
        const button = document.createElement('button');
        button.textContent = item;
        button.onclick = (e) => {
            e.preventDefault();
            toggleItem(meal, category, item);
        };
        button.className = 'menu-button ' + (isItemSelected(meal, category, item) ? 'selected' : '');
        categoryDiv.appendChild(button);
    });

    return categoryDiv;
}

function isItemSelected(meal, category, item) {
    if (meal === 'night') {
        return selectedItems[meal].includes(item);
    }
    return selectedItems[meal][category].includes(item);
}

function getCategoryTitle(category) {
    const titles = {
        starters: 'מנות ראשונות (בחר 2)',
        mains: 'מנות עיקריות (בחר 2)',
        sides: 'תוספות (בחר 3)',
        salads: 'סלטים (בחר 6)',
        desserts: 'קינוחים (בחר 1)'
    };
    return titles[category] || category;
}

function toggleItem(meal, category, item) {
    if (meal === 'night') {
        toggleNightItem(item);
    } else {
        toggleMealItem(meal, category, item);
    }
    updateButtonState(meal, category, item);
    updateSummary();
}

function toggleMealItem(meal, category, item) {
    const items = selectedItems[meal][category];
    const index = items.indexOf(item);
    const limits = { starters: 2, mains: 2, sides: 3, salads: 6, desserts: 1 };

    if (index === -1) {
        if (items.length >= limits[category]) {
            alert('ניתן לבחור עד ' + limits[category] + ' ' + getCategoryTitle(category));
            return;
        }
        items.push(item);
    } else {
        items.splice(index, 1);
    }
}

function toggleNightItem(item) {
    const items = selectedItems.night;
    const index = items.indexOf(item);
    if (index === -1) {
        if (items.length >= 4) {
            alert('ניתן לבחור עד 4 פריטים לאוכל לילה');
            return;
        }
        items.push(item);
    } else {
        items.splice(index, 1);
    }
}

function updateButtonState(meal, category, item) {
    const buttons = document.querySelectorAll('#menuOptions button');
    buttons.forEach(button => {
        if (button.textContent === item) {
            button.classList.toggle('selected', isItemSelected(meal, category, item));
        }
    });
}

function updateSummary() {
    const summary = $('orderSummary');
    summary.innerHTML = '';

    for (const meal in selectedItems) {
        let items = [];
        if (meal === 'night') {
            items = selectedItems[meal];
        } else {
            for (const category in selectedItems[meal]) {
                items = items.concat(selectedItems[meal][category]);
            }
        }
        if (items.length > 0) {
            const mealTitle = meal === 'night' ? 'אוכל לילה' : (meal === 'dinner' ? 'ארוחת ערב' : 'ארוחת בוקר');
            summary.innerHTML += '<p><strong>' + mealTitle + ':</strong> ' + items.join(', ') + '</p>';
        }
    }

    calculateTotal();
}

function calculateTotal() {
    const numberOfMeals = parseInt($('numberOfMeals').value) || 1;
    const pricePerMeal = 160;
    let totalPrice = pricePerMeal * numberOfMeals;

    // Add room prices to the total price
    for (const roomKey in selectedRooms) {
        totalPrice += selectedRooms[roomKey].price;
    }

    $('SumTotal').textContent = '₪' + totalPrice;
}

// Date selection
function initDateSelection() {
    $('OrderDate').addEventListener('change', function() {
        const date = new Date(this.value);
        const daysOfWeek = ["ראשון", "שני", "שלישי", "רביעי", "חמישי", "שישי", "שבת"];
        $('dayOfWeekResult').innerText = daysOfWeek[date.getDay()];

        document.querySelectorAll('.hidden-menu').forEach(menu => menu.classList.remove('active'));
        $(date.getDay() === 5 || date.getDay() === 6 ? 'Saturday' : 'MidWeek').classList.add('active');
    });
}

// Location selection
function initLocationSelection() {
    document.querySelectorAll('button[name="option"]').forEach(button => {
        button.addEventListener('click', function(event) {
            event.preventDefault();
            const formData = new FormData($('bookingForm'));

            document.querySelectorAll('#locations span').forEach(location => location.classList.remove('active'));
            $(this.value).classList.add('active');

            // Restore form data
            formData.forEach((value, key) => {
                const field = $('bookingForm').elements[key];
                if (field) {
                    field.value = value;
                }
            });
        });
    });
}

// Booking summary
function generateBookingSummary() {
    const formData = new FormData($('bookingForm'));
    let summary = "סיכום הזמנה לשבת אירוח:\n\n";

    summary += 'שם: ' + formData.get('name') + '\n';
    summary += 'אימייל: ' + formData.get('email') + '\n';
    summary += 'טלפון: ' + formData.get('phone') + '\n';
    summary += $('dayOfWeekResult').innerText + ' ' + formData.get('OrderDate') + '\n\n';

    let complexGroups = {};
    let totalRoomPrice = 0; // Initialize total room price
    for (const [key, room] of Object.entries(selectedRooms)) {
        if (!complexGroups[room.complex]) {
            complexGroups[room.complex] = [];
        }
        complexGroups[room.complex].push(room);
        totalRoomPrice += room.price; // Add room price to total room price
    }

    for (const [complex, rooms] of Object.entries(complexGroups)) {
        summary += '*' + complex + '*: \n';
        rooms.forEach(room => {
            summary += '- חדר ' + room.number + ' (₪' + room.price + ')\n';
        });
        summary += '\n';
    }

    summary += '*תפריט שנבחר*\n';
    for (const meal in selectedItems) {
        let items = meal === 'night' ? selectedItems[meal] : 
                    Object.values(selectedItems[meal]).flat();
        if (items.length > 0) {
            const mealTitle = meal === 'night' ? 'אוכל לילה' : (meal === 'dinner' ? 'ארוחת ערב' : 'ארוחת בוקר');
            summary += mealTitle + ': ' + items.join(', ') + '\n';
        }
    }

    const specialRequests = formData.get('specialRequests');
    if (specialRequests) {
        summary += '\nבקשות מיוחדות: ' + specialRequests + '\n';
    }

    // Calculate total price including room prices
    const numberOfMeals = parseInt($('numberOfMeals').value) || 1;
    const pricePerMeal = 160;
    const totalMealPrice = pricePerMeal * numberOfMeals;
    const totalPrice = totalMealPrice + totalRoomPrice;

    summary += '\nסה"כ לתשלום: ₪' + totalPrice;

    return summary;
}

function shareOnWhatsApp() {
    const summary = generateBookingSummary();
    const encodedSummary = encodeURIComponent(summary);
    window.open('https://wa.me/+972547431304?text=' + encodedSummary, '_blank');
}

function shareOnMail() {
    const summary = generateBookingSummary();
    const encodedSummary = encodeURIComponent(summary);
    window.location.href = 'mailto:?subject=סיכום הזמנה לשבת אירוח&body=' + encodedSummary;
}

// Initialize everything
function init() {
    initRoomSelection();
    initDateSelection();
    initLocationSelection();
    $('numberOfMeals').addEventListener('input', calculateTotal);
}

// Call init when the DOM is fully loaded
document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>